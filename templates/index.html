<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìµëª… í¬ë¦¬ìŠ¤ë§ˆìŠ¤ í¸ì§€í•¨</title>
    <style>
        body { font-family: 'Apple SD Gothic Neo', sans-serif; background: #fdf2f2; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .container { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 400px; text-align: center; border: 2px solid #e63946; }
        h2 { color: #e63946; }
        select, input, textarea { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
        textarea { height: 100px; resize: none; }
        button { width: 100%; padding: 15px; background: #e63946; border: none; border-radius: 10px; color: white; font-size: 16px; font-weight: bold; cursor: pointer; }
        button:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ„ ìµëª… ë§ˆìŒ ì „ë‹¬ì†Œ</h2>
        <input type="text" id="senderName" placeholder="ë³´ë‚´ëŠ” ì‚¬ëŒ (ê´€ë¦¬ì í™•ì¸ìš©)">
        <select id="memberSelect">
            <option value="">ë°›ëŠ” ì‚¬ëŒ ì„ íƒ</option>
            {% for member in members %}
            <option value="{{ member.id }}">{{ member.name }}</option>
            {% endfor %}
        </select>
        <textarea id="message" placeholder="ë©”ì‹œì§€ë¥¼ ì ì–´ì£¼ì„¸ìš” (ì‚¬ì§„ìœ¼ë¡œ ë³€í™˜ë©ë‹ˆë‹¤)"></textarea>
        <button id="sendBtn" onclick="sendMessage()">ìµëª… í¸ì§€ ë³´ë‚´ê¸°</button>
    </div>

    <script>
        function sendMessage() {
            const btn = document.getElementById('sendBtn');
            const data = {
                userId: document.getElementById('memberSelect').value,
                userName: document.getElementById('memberSelect').options[document.getElementById('memberSelect').selectedIndex]?.text,
                senderName: document.getElementById('senderName').value,
                message: document.getElementById('message').value
            };

            if (!data.userId || !data.message || !data.senderName) return alert("ë‚´ìš©ì„ ë‹¤ ì±„ì›Œì£¼ì„¸ìš”!");

            btn.disabled = true;
            btn.innerText = "ì „ì†¡ ì¤‘...";

            fetch('/send', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            }).then(() => {
                alert("í¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ë‹¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
                document.getElementById('message').value = "";
                let count = 3;
                const timer = setInterval(() => {
                    btn.innerText = `ëŒ€ê¸° ì¤‘ (${count}ì´ˆ)`;
                    if (count-- <= 0) {
                        clearInterval(timer);
                        btn.disabled = false;
                        btn.innerText = "ìµëª… í¸ì§€ ë³´ë‚´ê¸°";
                    }
                }, 1000);
            });
        }
    </script>
</body>
</html>
